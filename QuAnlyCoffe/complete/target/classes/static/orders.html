<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Danh sách Đơn hàng</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/style.css}" />
</head>
<body>
<nav class="navbar">
    <ul>
        <li><a th:href="@{/}">Trang chủ</a></li>
        <li><a th:href="@{/orders}">Đơn hàng</a></li>
        <li><a th:href="@{/menu}">Sản phẩm</a></li>
        <li><a th:href="@{/nhanvien}">Nhân viên</a></li>
    </ul>
</nav>

<div class="container">
    <h2>Danh sách đơn hàng</h2>

    <div th:if="${orders != null and #lists.isEmpty(orders)}">
        <p style="text-align:center; color:gray;">Chưa có đơn hàng nào.</p>
    </div>

    <div th:if="${orders != null and !#lists.isEmpty(orders)}">
        <table>
            <thead>
            <tr>
                <th>Mã ĐH</th>
                <th>Sản phẩm</th>
                <th>Giá</th>
                <th>Số lượng</th>
                <th>Thành tiền</th>
                <th>Nhân viên thực hiện</th>
                <th>Ngày đặt</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="order : ${orders}">
                <td th:text="${order.maDonHang}"></td>
                <td th:text="${order.product != null ? order.product.name : 'N/A'}"></td>
                <td th:text="${order.product != null ? order.product.price : 0}"></td>
                <td th:text="${order.soLuong}"></td>
                <td th:text="${order.product != null ? order.soLuong * order.product.price : 0}"></td>
                <td th:text="${order.nhanVien != null ? order.nhanVien.ten + ' - ' + order.nhanVien.chucVu : 'N/A'}"></td>
                <td th:text="${order.orderDate}"></td>
            </tr>
            </tbody>
        </table>

        <h3>Tổng tiền đơn hàng: <span th:text="${tongTien} + ' đ'">0 đ</span></h3>
    </div>

    <h2>Thêm đơn hàng mới</h2>
    <form th:action="@{/orders/add}" method="post">
        <!-- Chọn nhân viên -->
        <select name="nhanVienId" required>
            <option value="" disabled selected>-- Chọn nhân viên --</option>
            <option th:each="nv : ${nhanViens}" th:value="${nv.id}" 
                    th:text="${nv.ten + ' - ' + nv.chucVu}"></option>
        </select>

        <!-- Chọn sản phẩm -->
        <select name="productId" required>
            <option value="" disabled selected>-- Chọn sản phẩm --</option>
            <option th:each="sp : ${products}" th:value="${sp.id}" 
                    th:text="${sp.name + ' - ' + sp.price + 'đ'}"></option>
        </select>

        <input type="number" name="soLuong" placeholder="Số lượng" required min="1">
        <button type="submit">Thêm</button>
    </form>

    <h2>Xoá đơn hàng</h2>
    <form th:action="@{/orders/delete}" method="post">
        <input type="number" name="maDonHang" placeholder="Mã Đơn Hàng" required>
        <button type="submit">Xoá</button>
    </form>
</div>
</body>
</html>
